import pyttsx3
import  speech_recognition as sr
import datetime
import os
import wikipedia
import pywhatkit
import pyautogui
import pyjokes
engine=pyttsx3.init('sapi5')
voices=engine.getProperty('voices')
engine.setProperty('voices',voices[0].id)

def speak(audio):
    engine.say(audio)
    engine.runAndWait()


def commands():
    r=sr.Recognizer()
    with sr.Microphone() as source:
        print("Listnening...")
        r.pause_threshold=1
        r.adjust_for_ambient_noise(source,duration=1)
        audio=r.listen(source)
    try:
        print("Wait for Few Moments...")
        query=r.recognize_google(audio,language='en-in')
        print(f"you just said:{query}\n")
    except Exception as e:
        print(e)
        
        speak("please tell me again")
        query="none"
    return query
def wishings():
    hour=int(datetime.datetime.now().hour)
    if hour>=0 and hour<12:
        print("Good Morning Boss")
        speak("Good Morning Boss")
    elif hour>=12 and hour<17:
        print("Good Afternoon Boss")
        speak("Good Afternoon Boss")
    elif hour>=17 and hour<21:
        print("Good Evening Boss")
        speak("Good Evening BosS")
    else:
        print("Good Night Boss")
        speak("Good Night Boss")

if __name__=="__main__":
    wishings()
    query=commands().lower()
    if 'time' in query:
        strTime=datetime.datetime.now().strftime("%H:%M:%S")
        print(strTime)
        speak(f"Boss,the time is {strTime}")
    elif "open firefox" in query:
        speak("Opening Firefox Application Boss....")
        os.startfile("C:\\Users\\Shalini V\\AppData\\Local\\Mozilla Firefox\\firefox.exe")
    elif 'wikipedia' in query:
        speak("searching in wikipedia;....")
        try:
            query=query.replace("wikipedia","")
            results=wikipedia.summary(query,sentences=1)
            speak("According to wikipedia,")
            print(results)
            speak(results)
        except:
            speak("No results found...")
            print("No results found...")

    elif 'play' in query:
        query=query.replace('play','')
        speak('playing' + query)
        pywhatkit.playonyt(query)
    elif 'type' in query:
        speak("please tell me what should I what i am saying write")
        while True:
            typeQuery = commands()
            if typeQuery == "exit typing":
                speak("Done Boss")
                break
            else:
                pyautogui.write(typeQuery)
    elif 'minimize'in query or 'minimise' in query:
        pyautogui.moveTo(1234,15)
        pyautogui.leftClick()
    elif 'joke' in query:
        jarvisjoke=pyjokes.get_joke()
        print(jarvisjoke)
        speak(jarvisjoke)
    elif "magic sentences" in query:
        speak("Yes Boss, for ypur pleasure!")
    elif "what can you do for me" in query:
        speak("Yes Boss, Nice question")
        speak("As per my program, I am able to spot which can perform tasks through your voice commands")
    elif "cool" in query or "nice" in query or "awsome" in query or "thank you " in query:
        speak("yes Boss,That's my Pleasure!")   
    elif "minimize" in query or "minimise" in query:
        speak("Mnimizing boss")
        pyautogui.hotkey('win','down','down')
    elif "maximize" in query or "maximise" in query:
        speak("Maximizing Boss")
        pyautogui.hotkey('win','up','up')
    elif "close the window" in query or "close the application" in query:
        speak("closing sir!")
        pyautogui.hotkey('ctrl','w')
    elif "screenhot" in query:
        speak("Taking Screenshot Boss...")
        pyautogui.press('prtsc')
    elif 'exit program' in query:
        speak(" I am leaving Boss, BYE!")
        quit()










        

        
    



